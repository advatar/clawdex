# Status

Active:
- [x] Reset `openclaw` submodule to repo-pinned SHA, sync to latest `openclaw/main`, and port newly applicable upstream parity changes into `clawdex`.
- [x] Integrate `clawdex_claude_plugins_artifacts` into runtime wiring (compile schema module + DB marketplace/error migrations).
- [x] macOS Plugin Manager UX pass: add OpenClawHub plugin/skill discovery search and guarantee bundled Claude plugins are preinstalled/usable on first run.
- [x] Close LLM-OS alignment gaps (policy enforcement, explicit controller states, context budgeting).
  - [x] Enforce `permissions.mcp` allow/deny + per-server policy at built-in MCP tool dispatch.
  - [x] Add explicit `plan -> act -> verify` controller-state events for task/cron runs.
  - [x] Add configurable context budget controls and apply them to long prompt inputs.
- [x] Add a dedicated self-hosted GitHub Actions workflow for Clawhatch scans on a labeled laptop runner and document setup/runbook.
- [x] Add automated Clawhatch security scan in CI (push/PR + daily schedule) scoped to clawdex workspace context (OpenClaw-specific config checks limited).
- [x] Add decentralized Antenna peer networking support: multi-relay bootstrap/fallback in mac app + Rust relay/discovery service integration.
- [x] Fix current build blockers reported in local environments: make Antenna peer-assist compile without `AntennaProtocol` present and remove `ParallellVibeExample` `main.swift`/`@main` ambiguity.
- [x] Add proactive peer-engagement behavior in `macClawdex` so peer assist can trigger automatically for stuck/second-opinion cases and optional discussion-mode posts (not only `/peers`).
- [x] Integrate `Packages/DeepThink` into `macClawdex` and add an optional parallel-agent prepass path in the app runtime.
- [x] Integrate AntennaProtocol in macClawdex and ship a peer-assist flow for reaching external agent peers (relay-published MBP2P help requests).
- [x] Upstream sync pass: bump `openclaw`/`codex` submodules to latest `main` and backport any newly applicable OpenClaw parity fixes.
- [x] Document Antenna peer-assist integration in user/dev docs (`README.md`, `MAC_APP.md`, `docs/ai/*`).
- [x] WORK.md execution pass: close remaining task-runtime gaps starting with `tasks follow` live event tailing, then continue with run lifecycle controls (`cancel`/`resume`/`fork`).
  - [x] Add `clawdex tasks follow --run-id <id>` live event tailing and wire it into the CLI.
  - [x] Add `clawdex tasks cancel --run-id <id>` and wire cancellation to app-server `turn/interrupt`.
  - [x] Expose cancellation in the legacy task HTTP server via `POST /v1/runs/{id}/cancel`.
  - [x] Add regression test coverage for cancellation flagging (`cancel_run_command_sets_cancel_requested_flag`).
  - [x] Add `clawdex tasks resume --run-id <id>` wired to app-server `thread/resume`.
  - [x] Add `clawdex tasks fork --run-id <id>` wired to app-server `thread/fork`.
  - [x] Extend daemon `POST /v1/runs` to accept `resumeFromRunId` / `forkFromRunId` for async run continuation.
  - [x] Reconcile `WORK.md` implementation checkboxes with shipped task/approval/plugin/output/scheduler/audit capabilities.
  - [x] Add daemon local IPC over Unix domain sockets using JSON-RPC for app/CLI clients.
  - [x] Convert `ui_bridge` event flow to publish structured run events to subscribers (while keeping current message/error output compatibility).
  - [x] Document App Store connector constraints (built-in + remote connectors only; no local spawned MCP binaries).
  - [x] Reconcile stale narrative-phase checkboxes in `WORK.md` so only true remaining gaps stay unchecked.
  - [x] Close remaining WORK.md gaps:
    - [x] Finish plugin install parity: CLI/Admin `spec` + `--git` wiring, GitHub shorthand support, and skill provenance surfacing.
    - [x] Record cron daemon executions in the shared `task_runs/events` pipeline.
    - [x] Add gated memory writes with explicit scope (`global` / `workspace` / `plugin`).
    - [x] Add macOS UI action for exporting audit packets.
    - [x] Reconcile `WORK.md` checkboxes after implementation (including already-shipped approval/user-input/policy items).

Upstream Sync (Submodules):
- [x] Establish and follow a regular cadence to pull upstream changes into our forks and then bump the pinned submodule SHAs in this repo (`codex/` from `openai/main`, `openclaw/` from `openclaw/main`).
- [x] On each `openclaw/` bump: scan upstream skills/tooling for new/changed tool usage (`openclaw/src/agents/tools`, `openclaw/src/gateway/protocol/schema`), update `compat/` schemas/specs, and add regression tests before porting required behavior into `clawdex/`.
- [x] Codex sync policy is now explicit: prioritize `openclaw` parity bumps; review/bump `codex` opportunistically when integration deltas require it, and capture port tasks before implementation.
- [x] Keep submodule bump commits isolated (one `chore(submodules)` commit), and land parity/feature ports as separate commits with tests.
  - Latest bump: 2026-02-17 (codex `0fbe10a80`, openclaw `19f8b6bf4`)
  - [x] Port OpenClaw cron webhook delivery parity: accept `delivery.mode="webhook"` (including `sessionTarget="main"`), validate http(s) webhook targets, and emit daemon webhook callbacks with optional `cron.webhookToken`.
  - [x] Backport OpenClaw gateway send parity update: allow attachment-only / media-only sends (`message` optional in gateway send params) with regression tests.
  - [x] Security sweep on each openclaw bump: review published GH advisories + merged security PRs, run dependency audit, and patch/backport applicable fixes.
  - [x] Add `plugins/get-shit-done/` submodule support to the bundled-plugin flow (auto-install + Codex skills sync), including parsing Claude Code-style command frontmatter and rewriting `~/.claude/...` paths to `${CLAUDE_PLUGIN_ROOT}/...` for portability.
  - [x] Fix plugin disable/remove cleanup for command-derived skills that are not namespaced with the plugin id (e.g. `gsd:*` from `get-shit-done`).
  - [x] Mitigate bundled OpenClaw extension supply risk: retain `matrix` vulnerability notice (GHSA-p8p7-x288-28g6 in transitive `request`) with optional strict blocking via `CLAWDEX_BLOCK_VULNERABLE_PLUGINS=1` (default warning-only for upstream compatibility).
  - [x] Harden gateway attachment data reads to resolve by attachment id only (ignore index `path` field) and reject traversal-style ids with regression tests.
  - [x] Add daemon admin parity surface: `/admin` dashboard + `/v1/admin/*` APIs for overview, plugins, gateway channels, permissions, and config patching.
  - [x] Backport OpenClaw install-script hardening: add `--ignore-scripts` to npm dependency installs during plugin setup.
  - [x] Backport OpenClaw gateway WS payload policy bump for image uploads (`maxPayload` 8 MiB, `maxBufferedBytes` 16 MiB) with regression coverage.
  - [x] Backport OpenClaw heartbeat scheduler hardening: daemon heartbeat tick errors are logged and rescheduled instead of terminating `clawdexd`.
  - [x] Backport OpenClaw auth hardening: use constant-time secret comparison for configured gateway token/password checks.
  - [x] Parity sweep for OpenClaw `1567d6cbb..19f8b6bf4`: scan `src/agents/tools` + `src/gateway/protocol/schema`, port applicable behavior into `clawdex`, and add/update compat tests + schemas.
  - [x] Port OpenClaw cron session-namespace parity: support `cron.sessionKey` (normalize/patch/migration), prefer session-key route resolution for announce delivery, and expose `sessionKey` in cron + `channels.resolve_target` schemas with regression tests.
  - [x] Plugin/skills parity sweep: accept OpenClaw manifest-defined `skills`/`commands` component paths and remove hard plugin blocklists so all upstream OpenClaw plugins remain installable (with warning-only vulnerable dependency notice).

- [x] Add artifact service tools (xlsx/pptx/docx/pdf) with schema validation + hashing
- [x] Record artifact events and list outputs at end of task runs
- [x] Add builder skills plugin for spreadsheet/slide/report outputs
- [x] Add tamper-evident audit log with hash chain for task events/approvals/artifacts/plugins
- [x] Add ActionIntent + risk scoring + checkpoint metadata for approvals/tool calls
- [x] Add audit export command (events/approvals/artifacts/plugins + audit log)

- [x] Validate MCP tool arguments against OpenClaw JSON schemas
- [x] Expose OpenClaw JSON Schemas in MCP tool definitions
- [x] Default memory embeddings provider/model from Codex config overrides
- [x] Add parity tests for cron normalization edge cases + delivery rules
- [x] Add gateway protocol integration tests + tighten last-route fallback
- [x] Clean up CLI help text now that cron/heartbeat are live
- [x] Implement Rust `clawdex` core (MCP server, cron/memory stores, heartbeat stubs, skills sync, UI bridge)
- [x] Update macOS app embed script to build `codex` + `clawdex` Rust binaries (no Node/OpenClaw runtime)
- [x] Refresh docs for Rust-first flow (README, MAC_APP, COMPATIBILITY)
- [x] Replace remaining `codex-clawd` mentions with `clawdex`
- [x] Build minimal Rust gateway (HTTP + routing, `message.send` delivery)
- [x] Execute cron/heartbeat via Codex runner (`clawdex daemon`) with on-request approvals
- [x] Memory index: SQLite FTS5 + embeddings hybrid search (provider-configurable)
- [x] Update docs for gateway/daemon/memory/approval options + prebuilt binaries flow
- [x] Track `macClawdex/Resources/prebuilt` binaries in Git LFS
- [x] Implement non-stub channel tools (`channels.list`, `channels.resolve_target`) and complete `message.send` options
- [x] Strip reasoning tags (`<think>...</think>`, `<final>...</final>`) from outbound `message.send` text
- [x] Implement WORK.md Phase 0-2 foundations (task DB + task engine + streaming events)
- [x] Implement interactive approvals + tool user input broker for task runs
- [x] Add task CLI (`tasks.*`) and daemon IPC stub for future UI
- [x] Add workspace policy controls (allow roots, deny patterns, read-only, network access toggle)
- [x] Implement plugin manager (install/list/enable/disable, skill sync, MCP export)
- [x] Add plugin command discovery + execution (CLI + macOS app support)
- [x] Add permissions UI plus MCP allow/deny policies
- [x] Add command palette UX for plugin commands
- [x] Add per-plugin MCP toggles in config + UI
- [x] Add richer approval detail rendering (diff/command previews) in mac app
- [x] Add cron schedule UI for creating/editing jobs (mac app)
- [x] Add approvals + user-input UI (macOS) backed by daemon IPC
- [x] Implement cron runner loop + per-job policy execution
- [x] Preinstall bundled OpenClaw plugins on first app launch
- [x] Enforce gateway auth (token/password) for WS + HTTP endpoints
- [x] Track gateway WS presence + last-seen in hello snapshot
- [x] Track gateway message receipts for queued/sent/incoming events
- [x] Apply gateway channel order for route resolution + listing
- [x] Add gateway attachment upload/storage endpoints
- [x] Implement gateway auth token issuance/rotation/device flow
- [x] Guard daemon UI polling until daemon startup completes
- [x] Stop Xcode signing team resets by moving Development Team config to a local override
- [x] Build and stage prebuilt `clawdexd` universal binary
- [x] Add helper script to build/stage `clawdexd` prebuilt binary and document it in README
- [x] Create compat parity spec scaffolding (compat/README.md, clawd-compat.yaml, tool schemas, routing schema, test matrix)
- [x] Add cron schedule unit tests (at/every/cron+tz)
- [x] Fill compat tool schemas with OpenClaw-aligned JSON definitions
- [x] Implement P0 scenario tests from compat/tests/matrix.md
- [x] Implement gateway bridge session mapping + outbound delivery parity
- [x] Produce OpenClaw parity delta checklist and start closing gaps
- [x] Align cron storage format + run log responses with OpenClaw (versioned jobs, state.nextRunAtMs, finished runs)
- [x] Align cron.run semantics with OpenClaw (immediate run + {ok, ran, reason})
- [x] Align cron delivery object behavior and legacy patch merging with OpenClaw
- [x] Fix Claude plugin skill import (skills/<name>/SKILL.md), namespacing, and overlay paths
- [x] Convert plugin commands into namespaced skills with shared renderer semantics
- [x] Add Claude plugin manifest path resolution for skills/commands (additive + ./ rules)
- [x] Import Claude plugin marketplace artifacts bundle (CR/DiffPlan/schema/SQL)
- [x] Auto-install bundled Claude plugins by default for all users

Roadmap:
- [x] Add revised OpenClaw parity roadmap (mac app parity priority, web/admin nice-to-have) in `ROADMAP.md`.
- [x] Include plugin lifecycle + packaging + MCP/skills sync + mac app UX roadmap details.
- [x] Emphasize Rust-first parity and porting OpenClaw TypeScript components where needed.

Parity Execution (from ROADMAP.md):
- [x] Phase 0: Enforce MCP response strictness + add response-schema regression tests + update `compat/parity-delta.md`.
- [x] Phase 1: Plugin parity (packaging layer, lifecycle parity, metadata/deps validation, permissions mapping, skill/MCP sync hooks).
- [x] Phase 1a: Add OpenClaw plugin manifest support (`openclaw.plugin.json`) + package metadata ingestion.
- [x] Phase 1b: Add plugin install/update semantics (npm spec/archive/path) with dependency install + recorded install source.
- [x] Phase 1c: Align enable/disable/remove flows with OpenClaw semantics + wire skill/MCP sync hooks.
- [x] Phase 1d: Map plugin permission hints into MCP allow/deny + workspace policy overrides (if present).
- [x] Phase 2: Gateway core parity (auth flows, presence/last-seen, message lifecycle/receipts, channel stack order, attachments).
- [x] Phase 3: Server methods + lifecycle parity (registry, versioned handlers, plugin method discovery/reload, compat tests).
- [x] Phase 3a: Add gateway method registry with versioned handlers + methods.list
- [x] Phase 3b: Discover plugin gateway methods from manifests and support reload
- [x] Phase 3c: Add basic compat tests for method registry + reload
- [x] Phase 4: Advanced memory pipeline parity (watchers, batch embeddings queue/retry, cache/eviction, local backend).
- [x] Phase 4a: Use stored embeddings vectors for hybrid scoring (no per-query chunk re-embedding)
- [x] Phase 4b: Backfill embeddings for unchanged files when embeddings config becomes available
- [x] Phase 4c: Add optional memory sync/watch loop (configurable) to keep index warm
- [x] Phase 4d: Batch embeddings queue with retries/backoff + persistent failure metadata
- [x] Phase 4e: Local embeddings backend option (offline / no network)
  - [x] Add a local embeddings provider (Ollama HTTP) that works without an API key.
  - [x] Key embeddings cache + backoff metadata by provider/model to avoid cross-provider poisoning.
- [x] Phase 5: mac app functional parity (timeline, approvals UI, plugin management UI, connectors, attachments, config UI).
  - [x] Add plugin install/update UI (npm spec + local folder/link) and wire into main navigation.
  - [x] Add plugin enable/disable/remove actions to the Plugins UI.
  - [x] Add gateway UI for routes (session keys), receipts, and attachments (upload/list/download).
  - [x] Add chat attachment UX (image picker/preview + send as local image inputs) where supported.
  - [x] Add memory settings controls (enable + embeddings provider/model/sync) to the Settings UI.
  - [x] Add basic task runs timeline: list runs per task + select run + tail/stream events.
- [x] Phase 6: Web/admin parity (dashboards + admin workflows where implemented).
  - [x] Add daemon-served admin API endpoints for plugins, gateway status/channels, permissions, and config patching.
  - [x] Add a minimal web admin dashboard (`/admin`) for session oversight plus plugin/gateway/memory management actions.
  - [x] Add validation coverage for admin API flows and document new endpoints/commands in AI docs.

Notes:
- `TEMPLATE_PACK.md` is the parity checklist: use it later to fill tool schemas, routing rules, and tests, then implement remaining gaps using the name `Clawdex`.
- `MAC_APP.md` already references the Rust UI bridge and the prebuilt binaries helper; keep it in sync if flow changes.
