version: 1
commands:
  - name: cargo-test
    description: Run clawdex Rust tests
    cmd: cargo test --manifest-path clawdex/Cargo.toml
  - name: mac-build
    description: Build the macOS app without code signing
    cmd: xcodebuild -project macClawdex/Clawdex.xcodeproj -scheme Clawdex -configuration Debug -destination 'platform=macOS' build CODE_SIGNING_ALLOWED=NO CODE_SIGNING_REQUIRED=NO CODE_SIGN_IDENTITY=''
  - name: daemon-health
    description: Check local clawdexd daemon health endpoint
    cmd: curl -sS http://127.0.0.1:18791/v1/health
  - name: daemon-ipc-health
    description: Check clawdexd local IPC socket via JSON-RPC (`health` method)
    cmd: python3 -c "import json,socket,os; p=os.path.expanduser('~/.codex/clawdex/daemon.sock'); s=socket.socket(socket.AF_UNIX,socket.SOCK_STREAM); s.connect(p); s.sendall((json.dumps({'jsonrpc':'2.0','id':'health','method':'health'})+'\\n').encode()); print(s.recv(4096).decode().strip())"
  - name: daemon-admin-overview
    description: Inspect daemon admin overview snapshot (counts + runtime paths)
    cmd: curl -sS http://127.0.0.1:18791/v1/admin/overview | jq '{counts,daemon}'
  - name: daemon-admin-plugins
    description: List plugins through daemon admin API
    cmd: curl -sS 'http://127.0.0.1:18791/v1/admin/plugins?includeDisabled=true' | jq '.plugins'
  - name: clawdex-cli
    description: Run the clawdex CLI from source
    cmd: cargo run --manifest-path clawdex/Cargo.toml -- <args>
  - name: tasks-follow
    description: Tail task-run events until the run reaches a terminal state
    cmd: cargo run --manifest-path clawdex/Cargo.toml -- tasks follow --run-id <run-id>
  - name: tasks-resume
    description: Resume an existing run thread and submit a new prompt turn
    cmd: cargo run --manifest-path clawdex/Cargo.toml -- tasks resume --run-id <run-id> --prompt '<text>'
  - name: tasks-fork
    description: Fork an existing run thread and submit a new prompt turn on the branch
    cmd: cargo run --manifest-path clawdex/Cargo.toml -- tasks fork --run-id <run-id> --prompt '<text>'
  - name: tasks-cancel
    description: Request cancellation of a running task run
    cmd: cargo run --manifest-path clawdex/Cargo.toml -- tasks cancel --run-id <run-id>
  - name: tasks-audit-export
    description: Export a task-run audit packet (events/approvals/artifacts/plugins/audit-log)
    cmd: cargo run --manifest-path clawdex/Cargo.toml -- tasks audit-export --run-id <run-id> --output <path>
  - name: plugins-add-git
    description: Install a plugin directly from Git (URL or owner/repo[/subdir] shorthand)
    cmd: cargo run --manifest-path clawdex/Cargo.toml -- plugins add anthropics/knowledge-work-plugins/<role>
  - name: permissions-set-mcp-server
    description: Set per-MCP-server policy mode (ask_every_time|allow_once|allow_always|deny)
    cmd: cargo run --manifest-path clawdex/Cargo.toml -- permissions set --mcp-server '<server>=ask_every_time'
