version: 1
services:
  - name: clawdex-gateway
    owner: clawdex
    description: HTTP gateway for OpenClaw-compatible routing.
    command: clawdex gateway --bind 127.0.0.1:18789
    ports:
      - name: http
        port: 18789
        protocol: http
    health: none
    dependencies:
      - state_dir
      - workspace_dir
  - name: clawdex-daemon
    owner: clawdex
    description: Daemon runtime exposing HTTP admin/task APIs plus local Unix socket JSON-RPC IPC (`daemon.request`).
    command: clawdexd --bind 127.0.0.1:18791 --ipc-uds ~/.codex/clawdex/daemon.sock
    ports:
      - name: http
        port: 18791
        protocol: http
    sockets:
      - name: ipc
        path: ~/.codex/clawdex/daemon.sock
        protocol: jsonrpc
    health: /v1/health
    dependencies:
      - state_dir
      - workspace_dir
      - codex_bin
  - name: clawdex-task-server
    owner: clawdex
    description: Legacy task HTTP server (CLI/debug path).
    command: clawdex tasks server --bind 127.0.0.1:18790
    ports:
      - name: http
        port: 18790
        protocol: http
    health: none
    dependencies:
      - state_dir
      - workspace_dir
